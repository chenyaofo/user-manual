(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{388:function(e,t,v){"use strict";v.r(t);var a=v(25),_=Object(a.a)({},(function(){var e=this,t=e.$createElement,v=e._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("h1",{attrs:{id:"freeipa账号迁移"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#freeipa账号迁移"}},[e._v("#")]),e._v(" FreeIPA账号迁移")]),e._v(" "),v("p",[e._v("实验室手动给同学们分配账号由来已久，各台服务器上都有大量的本地账号存在。")]),e._v(" "),v("p",[e._v("本文档意图指导大家在尽量不影响实验的情况下，将账号迁移至FreeIPA中。")]),e._v(" "),v("p",[e._v("迁移完成后将可以使用"),v("RouterLink",{attrs:{to:"/storage/"}},[e._v("分布式存储")])],1),e._v(" "),v("h2",{attrs:{id:"计划"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#计划"}},[e._v("#")]),e._v(" 计划")]),e._v(" "),v("p",[e._v("迁移将以灰度方式逐渐完成。在迁移过程中，将一部分服务器接入FreeIPA，未接入的服务器则按原有方式登录。根据操作的进度和大家的反馈，逐步增加接入服务器的数量。")]),e._v(" "),v("p",[e._v("对之前在已接入的服务器中的任意一台上拥有账号的同学，Infra团队会为你分配FreeIPA账号，并主动联系你告知初始密码。若你认为你应该收到却未收到初始密码，请联系Infra团队。")]),e._v(" "),v("h2",{attrs:{id:"需要的操作"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#需要的操作"}},[e._v("#")]),e._v(" 需要的操作")]),e._v(" "),v("p",[e._v("收到密码的同学可使用FreeIPA账号登录任何已接入的服务器，也可以使用你原有的登录方式登录原来有账号的服务器。请在合适的时候，使用迁移脚本清除本地账号，完全接入FreeIPA：")]),e._v(" "),v("div",{staticClass:"language-bash extra-class"},[v("pre",{pre:!0,attrs:{class:"language-bash"}},[v("code",[v("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ipa-migrate\n")])])]),v("p",[e._v("此过程根据你home目录中文件数量，可能需要几秒到几十分钟的时间（chown所需时间）。")]),e._v(" "),v("p",[e._v("迁移后：")]),e._v(" "),v("ul",[v("li",[e._v("你的所有文件将会保留。")]),e._v(" "),v("li",[e._v("你将不能使用原有密码登录，必需使用FreeIPA的密码。")]),e._v(" "),v("li",[e._v("你依然可以使用原来的公钥登录，同时你也可以使用FreeIPA中"),v("RouterLink",{attrs:{to:"/auth/self-service.html#添加ssh公钥"}},[e._v("录入")]),e._v("的公钥。")],1),e._v(" "),v("li",[e._v("你的uid、gid将更新。")]),e._v(" "),v("li",[e._v("你的home目录的权限将自动更新。若在home目录外还有你所有的文件，请联系管理员更新权限。")])]),e._v(" "),v("p",[e._v("需要注意：")]),e._v(" "),v("ul",[v("li",[e._v("每台服务器均可独立迁移，你可根据自己的实际情况控制迁移进度。若暂不进行迁移应该不会影响正常操作。")]),e._v(" "),v("li",[e._v("在运行迁移脚本前，请结束在该主机上，除正在操作的shell外的所有进程。")])]),e._v(" "),v("p",[e._v("再次登录后，运行"),v("code",[e._v("id")]),e._v("命令确认是否迁移成功。若显示uid为8596XXXXX则表示已经迁移成功，否则请联系Infra团队。")]),e._v(" "),v("h2",{attrs:{id:"faq"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#faq"}},[e._v("#")]),e._v(" FAQ")]),e._v(" "),v("ul",[v("li",[v("p",[e._v("账户迁移和分布式存储有什么关系？")]),e._v(" "),v("p",[e._v("迁移后才有权限在分布式存储中创建文件。但你的文件依然会保留在原来的位置，并不会自动迁移到分布式存储上。如有需要，可以自行将数据复制到"),v("code",[e._v("/mnt/cephfs")]),e._v("中")])]),e._v(" "),v("li",[v("p",[e._v("迁移是否有期限？不迁移是否有不良后果？")]),e._v(" "),v("p",[e._v("目前暂时没有期限，若不迁移应该不会影响任何正常服务器的使用，但你将没有权限使用分布式存储。")])])])])}),[],!1,null,null,null);t.default=_.exports}}]);